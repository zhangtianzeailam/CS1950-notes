# 恩尼格玛密码机

## 由来

在密码学史中，**恩尼格玛密码机**（德语：Enigma，又译**哑谜机**，或**“谜”式密码机**）是一种用于加密与解密文件的密码机。确切地说，恩尼格玛是对二战时期纳粹德国使用的一系列相似的转子机械加解密机器的统称，它包括了许多不同的型号，为密码学对称加密算法的流加密。

## 组成

转子，反射器，接线板。

## 加密原理

Enigma密码机的构造

共由五个主要部件组成。分别是：

包含26个英文字母的键盘： 输入端，每次输入一个英文字母。
线路接线板： 将l对字母相连接，进行加密工作。
扰频组合： 由快速扰频器、中速扰频器、慢速扰频器组成，进行加密工作。
反射器： 保证加密后得到的字母与输入的字母一定不相同。
包含26个英文字母的显示灯的显示灯板： 输出端，在键盘上输入一个英文字母后，灯盘上都会有一个英文字母亮起来，代表明文字母加密后的所对应的密文字母。
Enigma密码机的加密原理
    Enigma密码机加密是一种多表代换的对称加密算法，逐字母加密。除此之外，Enigma密码机是对称加密，加解密过程一致，不论加密还是解密，

明文空间：P ∈ { A } n P\in \mathbb{\{A\}^n}P∈{A} 
n
 ，A \mathbb{A}A表示字母表{ A − Z } \{A-Z\}{A−Z}

密文空间：C ∈ { A } n C\in \mathbb{\{A\}^n}C∈{A} 
n


秘钥：K 1 ， K 2 K1，K2K1，K2，分别表示接线板和三个转子的初始位置

加解密算法：

设置好K 1 K1K1和K 2 K2K2后，明文P PP 经过：

① 标有26个英文字母的线路接线板（S SS）

②扰频组合（R RR）

③反射器（T TT）

④扰频组合（R − 1 R^{-1}R 
−1
 ）

⑤标有26个英文字母的线路接线板(S SS)

得到密文C CC，解密同理。因为加解密算法一致，所以此处不作区分。
C = E n c K 1 , K 2 ( P ) P = E n c K 1 , K 2 ( C ) C =Enc_{K1,K2}(P)\\ P = Enc_{K1,K2}(C)
C=Enc 
K1,K2

 (P)
P=Enc 
K1,K2

 (C)

扰频器的作用

   扰频器也称作转子。单个转子的加密是一种单表置换。转子的左右两侧各有26个点，分别代表A-Z这26个英文字母。一端输入一端输出。为了达到加密的目的，将左右两侧的字母交叉连接，例如：转子左侧的字母A并不与转子右侧的A相连，而是与字母E相连，即表示字母A经过扰频器的加密后变成了字母E。

   因为这种单个转子提供的密码表是固定不变的，加密出来的密文比较容易被破解,因此选择三个转子串联在一起从而达到加密的目的。
三个转子被串联后，输入的字母经过这三个转子被进行多次替换。如果转子不转，那么输入的字母不论经过几个串联的转子，最终得到的依旧是一个固定的密码表，安全性依旧不高。因此为了提高加密的安全性，每输入一个字母后，第一个转子就会自动转动一格。当第一个转子转动一圈后，第二个转子就转动一格。同理，第二个转子转动一圈后，第三个转子转动一格。这样原来的单表置换经过旋转变为多表置换，使得安全性更高。

   根据K e r c k h o f f s KerckhoffsKerckhoffs假设，加密算法的内部结构是公开的，也就是说转子的内部结构对于加解密双方来说是一致的。秘钥K 2 K2K2 包含的是转子的排列方式和初始位置，如果有n个转子，选用m个进行加密，秘钥空间为
∣ K 2 ∣ = A n m ∗ 2 6 3 |K2| = A_n^m*26^3
∣K2∣=A 
n
m

 ∗26 
3


   对于只有三个转子的Enigma机，密钥空间只有3 ! ∗ 2 6 3 = 105456 3!*26^3=1054563!∗26 
3
 =105456，这种级别的安全性是不够的，这时候接线板K 1 K1K1就起了关键作用。我们会在安全性分析中做解释。

反射器作用
   反射器的加密是一种固定的单表置换（这里的单表置换是自定义的，无密钥）。加密方式是将最后一个转子的其中两个触点连接起来，并将电流沿一个不同的路倒回到线路接线板。这样的反射器导致加密后的字母与输入字母一定不相同，并且使得Enigma密码机的加密过程是自反的，这也是加解密一致的关键部件。同时还让Enigma机有了另一个性质，即：一个字母不会加密成自身。



## 解密原理

在接收方将信息解密时，他会使用相反的步骤。首先，他也会将转子按照密码本中的记录设置好，然后他就会打入密文中的头六个字母，如果发送方操作正确的话，显示板上就会显示，这时接收方就会将设置转子，之后他就可将密电打入而得到原文了。